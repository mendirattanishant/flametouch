# More documentation about how to customize your build
# can be found here:
# https://docs.fastlane.tools
fastlane_version "2.98.0"

# This value helps us track success metrics for Fastfiles
# we automatically generate. Feel free to remove this line
# once you get things running smoothly!
generated_fastfile_id "a013db4d-c350-4f4a-a14e-2b7086017297"

default_platform :ios

#xcversion(version: "9")

# Fastfile actions accept additional configuration, but
# don't worry, fastlane will prompt you for required
# info which you can add here later
lane :beta do

    # https://docs.fastlane.tools/getting-started/ios/beta-deployment/#best-practices
    # rebuilds profile if the number of devices has changed
    register_devices(devices_file: "fastlane/devices.txt")
    match(type: "adhoc", force_for_new_devices: true)

    gym

    changelog_from_git_commits

    crashlytics(
        groups: ["Testers"],
        notifications: true,
        api_token: "c378fcb8538c8a0bb9aa7b1fc355017166ebb726"
    )
end

lane :release do
    match(type: "appstore")
    gym
    testflight
end

lane :dsyms do
    download_dsyms
    upload_symbols_to_crashlytics(
        :binary_path => "./Carthage/Build/iOS/Crashlytics.framework/uploadDSYM"
    )
end

lane :bump do
    increment_build_number
end

lane :icon do
    appicon(
        appicon_image_file: 'Image Resources/AppIcon.png',
        appicon_devices: [:ipad, :iphone, :ios_marketing],
        appicon_path: 'flametouch/Assets.xcassets',
    )
end
